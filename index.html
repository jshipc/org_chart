<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Organization Chart — JSON Inline Accordion</title>
  <style>
    /* Use a universal box-sizing so padding/margin calculations are predictable */
    * { box-sizing: border-box; }

    /* Base body styling: system font for speed/readability, max-width for readability */
    body {
      font-family: system-ui, sans-serif;
      line-height: 1.5;
      margin: 0;
      padding: 1rem;
      max-width: 80ch;
    }

    /* Responsive heading size */
    h1 {
      font-size: clamp(1.25rem, 2.5vw, 1.75rem);
      margin-bottom: 1rem;
    }

    /* Ordered list padding for indentation; remove index numbers while keeping indentation */
    ol {
      padding-left: 1.25rem;
      list-style: none;
    }

    /* Space between accordion sections */
    details {
      margin: 0.25rem 0;
    }

    /* Pointer cursor to indicate clickable summary */
    summary {
      cursor: pointer;
    }

    /* Cross-browser removal of default disclosure markers */
    details > summary { list-style: none; }
    details > summary::marker { content: ""; }
    details > summary::-webkit-details-marker { display: none; }

    /* Custom closed state icon */
    summary::before {
      content: "▸ "; /* triangle pointing right */
      transition: transform .2s ease;
    }

    /* Custom open state icon */
    details[open] > summary::before {
      content: "▾ "; /* triangle pointing down */
    }

    /* Tiny styling for contact chips; keep it minimal */
    .contacts { font-size: 0.9em; margin-left: .5rem; white-space: nowrap; }
    .contacts a { text-decoration: underline; }
    .sep { margin: 0 .25rem; }
  </style>
</head>
<body>
  <h1>Organization Chart</h1>
  <!-- Container where the generated org chart will be placed -->
  <div id="org-chart"></div>

  <script>
  /*
    Inline JSON data representing the organization hierarchy.
    Each object can have:
      - title: string (role name)
      - phone: string | null (optional)
      - email: string | null (optional)
      - subordinates: array of similar objects (optional)
  */
  const orgData = {
    title: "Chief Executive Officer (CEO)",
    phone: "+15550000001",
    email: "ceo@example.com",
    subordinates: [
      {
        title: "VP of Operations",
        phone: null,                 // Null -> show "none" for SMS
        email: "ops.vp@example.com",
        subordinates: [
          { 
            title: "Operations Manager — Region A",
            phone: "+15550000021",
            email: null,              // Null -> show "none" for Email
            subordinates: [
              { title: "Team Lead — Warehouse", phone: "+15550000031", email: "wh.lead@example.com" },
              { title: "Team Lead — Logistics", phone: null,            email: "log.lead@example.com" },
              { title: "Team Lead — Customer Service", phone: "+15550000033", email: null }
            ]
          },
          { 
            title: "Operations Manager — Region B",
            phone: "+15550000022",
            email: "opsb.manager@example.com",
            subordinates: [
              { title: "Team Lead — Fulfillment",   phone: null,            email: null },
              { title: "Team Lead — Transportation", phone: "+15550000035", email: "trans.lead@example.com" },
              { title: "Team Lead — Returns",        phone: "+15550000036", email: null }
            ]
          }
        ]
      },
      {
        title: "VP of Finance",
        phone: "+15550000002",
        email: "finance.vp@example.com",
        subordinates: [
          { 
            title: "Controller",
            phone: null,
            email: "controller@example.com",
            subordinates: [
              { title: "Senior Accountant", phone: "+15550000041", email: "sracct@example.com" },
              { title: "AP/AR Lead",        phone: null,            email: "apar.lead@example.com" },
              { title: "Payroll Lead",       phone: "+15550000043", email: null }
            ]
          },
          { 
            title: "Treasury Manager",
            phone: "+15550000023",
            email: null,
            subordinates: [
              { title: "Analyst — Cash", phone: "+15550000051", email: null },
              { title: "Analyst — Risk", phone: null,            email: "risk.analyst@example.com" }
            ]
          }
        ]
      },
      {
        title: "VP of Technology",
        phone: null,
        email: "tech.vp@example.com",
        subordinates: [
          { 
            title: "Engineering Manager",
            phone: "+15550000024",
            email: "eng.manager@example.com",
            subordinates: [
              { title: "Lead — Frontend", phone: "+15550000061", email: "fe.lead@example.com" },
              { title: "Lead — Backend",  phone: null,            email: "be.lead@example.com" },
              { title: "Lead — DevOps",   phone: "+15550000063", email: null }
            ]
          },
          { 
            title: "IT Manager",
            phone: "+15550000025",
            email: null,
            subordinates: [
              { title: "Systems Admin Lead", phone: "+15550000071", email: null },
              { title: "Service Desk Lead",  phone: null,            email: "sd.lead@example.com" }
            ]
          }
        ]
      },
      {
        title: "VP of Sales & Marketing",
        phone: "+15550000004",
        email: "salesmktg.vp@example.com",
        subordinates: [
          { 
            title: "Sales Manager — Enterprise",
            phone: null,
            email: "sales.ent@example.com",
            subordinates: [
              { title: "Account Lead — East", phone: "+15550000081", email: null },
              { title: "Account Lead — West", phone: null,            email: "acct.west@example.com" }
            ]
          },
          { 
            title: "Marketing Manager",
            phone: "+15550000026",
            email: "mktg.manager@example.com",
            subordinates: [
              { title: "Lead — Content", phone: null,            email: "content.lead@example.com" },
              { title: "Lead — Events",  phone: "+15550000083", email: null },
              { title: "Lead — Growth",  phone: "+15550000084", email: "growth.lead@example.com" }
            ]
          }
        ]
      }
    ]
  };

  // Build a tiny contact chip. If value is null, output "none" instead of a link.
  function contactChip(role) {
    const wrap = document.createElement('span');
    wrap.className = 'contacts';

    const sms = document.createElement('span');
    if (role.phone) {
      const a = document.createElement('a');
      a.href = `sms:${encodeURIComponent(role.phone)}`;
      a.textContent = 'SMS';
      a.setAttribute('aria-label', `Send SMS to ${role.title}`);
      sms.appendChild(a);
    } else {
      sms.textContent = 'none';
    }

    const email = document.createElement('span');
    if (role.email) {
      const a = document.createElement('a');
      a.href = `mailto:${encodeURIComponent(role.email)}`;
      a.textContent = 'Email';
      a.setAttribute('aria-label', `Send email to ${role.title}`);
      email.appendChild(a);
    } else {
      email.textContent = 'none';
    }

    // Compose: [ SMS | Email ]
    wrap.appendChild(document.createTextNode('['));
    wrap.appendChild(sms);
    const sep = document.createElement('span'); sep.className = 'sep'; sep.textContent = '|';
    wrap.appendChild(document.createTextNode(' '));
    wrap.appendChild(sep);
    wrap.appendChild(document.createTextNode(' '));
    wrap.appendChild(email);
    wrap.appendChild(document.createTextNode(' ]'));

    return wrap;
  }

  /*
    Recursive function to create a role element.
    - If the role has subordinates: create a <details> with a <summary> and nested list.
    - If no subordinates: create a simple <span> with the title.
  */
  function createRole(role) {
    if (role.subordinates && role.subordinates.length) {
      // Create a <details> container
      const details = document.createElement('details');

      // Create the clickable summary for this role
      const summary = document.createElement('summary');
      // Title
      const titleSpan = document.createElement('span');
      titleSpan.textContent = role.title;
      summary.appendChild(titleSpan);
      // Contacts sit inside the summary (inline), but we prevent toggle on link click below
      summary.appendChild(contactChip(role));

      details.appendChild(summary);

      // Create a list for subordinates
      const list = document.createElement('ol');

      // Recursively create each subordinate entry
      role.subordinates.forEach(sub => {
        const li = document.createElement('li');
        li.appendChild(createRole(sub));
        list.appendChild(li);
      });

      // Add the list to the details
      details.appendChild(list);

      return details;
    } else {
      // No subordinates: return a text element only
      const container = document.createElement('span');
      const titleSpan = document.createElement('span');
      titleSpan.textContent = role.title;
      container.appendChild(titleSpan);
      container.appendChild(contactChip(role));
      return container;
    }
  }

  // Prevent <details> from toggling when clicking links inside <summary>
  document.addEventListener('click', (e) => {
    if (e.target.closest('summary a')) {
      e.stopPropagation();
    }
  });

  // Build the org chart and insert into the container
  document.getElementById('org-chart').appendChild(createRole(orgData));
  </script>
</body>
</html>